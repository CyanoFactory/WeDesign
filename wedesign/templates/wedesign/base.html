{% comment %}
Base template

Author: Jonathan Karr, jkarr@stanford.edu
Affiliation: Covert Lab, Department of Bioengineering, Stanford University
Last updated: 2012-07-17

Copyright (c) 2013 Gabriel Kind <gkind@hs-mittweida.de>
Hochschule Mittweida, University of Applied Sciences

Released under the MIT license
{% endcomment %}

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="{{ LANGUAGE_CODE|default:"en-us" }}" xml:lang="{{ LANGUAGE_CODE|default:"en-us" }}" {% if LANGUAGE_BIDI %}dir="rtl"{% endif %}>
{% load static %}
<head>
	{% block head %}
    <title>{% block head_title %}CyanoFactory KB{% endblock %}</title>

    {% include "wedesign/base_head.html" %}

    <style type="text/css" media="all">{% block extrastyles %}{% endblock %}</style>

    <script type="text/javascript">
    $(document).ready(function() {
        ["Actions", "Export", "Share"].forEach(function(arg) {
            var page_actions = $("#page_actions");

            var cat = page_actions.find(".dropdown-header:contains(" + arg + ")");
            var n = cat.next();
            if (n.hasClass("divider") || n.length == 0) {
                cat.remove();
                n.remove();
            }
        });

        var last_elem = $("#page_actions").children().last();
        if (last_elem.hasClass("divider")) {
            last_elem.remove();
        }
    })

    register_action = function(category, callback) {
        var page_actions = $("#page_actions");

        if (page_actions.children().hasClass("disabled")) {
            page_actions.children().remove();
        }

        if (page_actions.find(".dropdown-header:contains(" + category + ")").length == 0) {
            // If that isn't the first category add a divider
            if (page_actions.children().count != 0) {
                page_actions.append($("<li></li>").addClass("divider"));
            }

            page_actions.append($("<li></li>").addClass("dropdown-header").text(category));
        }

        var cat = page_actions.find(".dropdown-header:contains(" + category + ")");

        var divider = cat.nextAll(".divider");

        if (divider.length == 0) {
            // Append at the end
            page_actions.append(callback());
        } else {
            // Append before divider
            $(divider[0]).before(callback());
        }
    }
    </script>
	{% endblock %}
</head>
<body>
	<!-- header -->
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom" role="navigation">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="{% url "wedesign:index" %}" class="pull-left"><img src="{% get_static_prefix %}cyano/img/banner.png"></a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-left">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Help <span class="caret"></span></a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="{% get_static_prefix %}wedesign/CellDesign-Manual.pdf">How to use WeDesign</a></li>
                            {# <li><a href="{% if species %}{% url "wedesign:license" species_wid=species.wid %}{% else %}{% url "wedesign:license" %}{% endif %}">License</a></li>#}
                        </ul>
                    </li>
                    {% if request.user.is_authenticated %}
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">{{ request.user.username }} <span class="caret"></span></a>
                        <ul class="dropdown-menu" role="menu">
                            {% comment %}
                            <li><a href="{% if species %}{% url "wedesign:user" username=request.user.username species_wid=species.wid %}{% else %}{% url "wedesign:user" username=request.user.username %}{% endif %}">My Profile</a></li>
                            <li><a href="{% if species %}{% url "wedesign:basket" species_wid=species.wid %}{% else %}{% url "wedesign:basket" %}{% endif %}">My Baskets</a></li>
                            <li class="divider"></li>
                            <li><a href="{% if species %}{% url "wedesign:account_change" species_wid=species.wid %}{% else %}{% url "wedesign:account_change" %}{% endif %}">Edit Profile</a></li>
                            <li><a href="{% url "password_change" %}">Change password</a></li>
                            <li class="divider"></li>
                            {% endcomment %}
                            <li><a href="{% url "logout" %}">Logout</a></li>
                        </ul>
                    </li>
                    {% if request.user.profile.is_admin %}
                    <li>
                        <a href="#" style="font-weight: bold; color: red;" data-toggle="tooltip" title="All permission checks are ignored.">Warning! Admin Permission.</a>
                        <!--<ul class="dropdown-menu" role="menu">
                        <li>All permission checks are ignored.</li>
                        <li>Login with a normal account when finished.</li>
                        </ul>-->
                    </li>
                    {% endif %}
                    {% else %}
                    <li><a href="{% if request.get_full_path|truncatechars:9 == '/login...' %}{{ request.get_full_path }}{% else %}{% if species %}{% url "login" species_wid=species.wid %}{% else %}{% url "login" %}{% endif %}?next={{ request.get_full_path|urlencode }}{% endif %}">Login</a></li>
                    <li><a href="{% url "register" %}">Sign up</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

	<div id="main">
		<!-- content -->
		<div id="content">
		<h1>{% block page_title %}{% endblock %}
		</h1>
		{% block content %}{% endblock %}		
		</div>
	</div>

	<!-- modal -->
	<div id="modal"></div>

	<!-- tooltip -->
	<div id="tooltip" class="ui-corner-all"></div>
</body>
</html>
